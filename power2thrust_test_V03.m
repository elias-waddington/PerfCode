load('V03_ac.mat')
load('V03_weight.mat')

M = [0.25
0.259385457
0.269029603
0.278919498
0.289043099
0.299389744
0.309950366
0.320717036
0.331682727
0.342841412
0.353871054
0.364504882
0.375237629
0.386062729
0.396974499
0.407968927
0.419046809
0.430207833
0.441450124
0.452540683
0.462963384
0.473343278
0.483672904
0.493944885
0.504151941
0.514286888
0.524382033
0.5344329
0.544431893
0.563058251
0.59174912
0.618266709
0.64254407
0.664556816
0.684281979
0.701786034
0.717170201
0.730572001
0.742139993
0.751370396
0.758873712
0.765183872
0.770458037];

h = [0
970.7289526
1961.15295
2969.425642
3993.822237
5032.78693
6084.950122
7149.07916
8224.051126
9308.860512
10402.6419
11502.13391
12602.14356
13701.81131
14800.39123
15897.32586
16992.54651
18085.87548
19176.98674
20265.57214
21348.60829
22416.99025
23470.17209
24507.64164
25528.92047
26533.56263
27525.00436
28502.99786
29467.00938
30416.52358
31326.20772
32160.3244
32918.3985
33601.1777
34209.31974
34746.08239
35215.59562
35622.90456
35973.20847
36271.77628
36524.3973
36736.84725
36914.4174];

PShaft = [22473534.91
22449081.48
22423960.82
22398208.45
22371857.65
22344938.28
22317476.15
22289494.24
22261013.32
22232051.67
22199763.52
22162367.24
22125056.35
22087861.98
22050811.16
22018450.41
21988045.48
21957889.14
21927992.99
21890719.54
21830048.71
21770068.7
21710814.67
21652320.11
21594616.84
21537735.04
21481484.59
21425883.39
21370965.78
21322437.13
21282721.45
21256225.99
21236113.77
21217833.67
21201419.54
21186828.27
21173985.25
21162783.34
21153104.26
21143518.66
21134740.84
21127315.91
21121079.89];

for i = 1:length(h)
    [Tout,Pout] = power2thrust_v01(M(i),ac,h(i));
    Ta(i) = interp1(Pout,Tout,PShaft(i));
    
end

% Pshaft = 22473534.91;

% Pshaft = interp1(Tout,Pout,11645); % (Shaft Power)
% 
% Pfc = Pshaft/.995/.97/.99/.99
